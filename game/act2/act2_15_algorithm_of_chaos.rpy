# =======================================================
# ACT 2 - Scene 15: Algorithm of Chaos
# File: act2_15_algorithm_of_chaos.rpy
# =======================================================

# ========= SCENE START TASKS =========
$ _current_scene_id = "act2_15_algorithm_of_chaos"
$ scene_mark(_current_scene_id, "entered")

label act2_15_algorithm_of_chaos:

    # ========= STAGE DIRECTIONS (cinema-first) =========
    # CAMERA: Two-shot framing for Zira and Noelle. Aeron in background or doorway—observer. Push-ins on key moments of connection or conflict.
    # LIGHTING: Intel Den lighting (silver-blue screens) mixing with Ghostline amber from Zira's equipment. Visual representation of their different approaches.
    # SFX: Loop — overlapping data sounds, Zira's Ghostline pings, Noelle's keyboard. One-shots — interface chimes, frustrated sighs, rare laughter.
    # FX/COMP: Split-screen effect possible—Zira's chaotic Ghostline map vs Noelle's structured analysis. Merging when they sync.
    # BLOCKING/PROPS: Intel Den with Zira's portable Ghostline rig added. Two workstations, deliberately different aesthetics. Tea going cold.
    # FACE: Zira expressive, animated, frustrated then delighted. Noelle controlled, then cracking into genuine engagement. Both surprised by how well they work together.

    # ========== A2_P12 — ZIRA×NOELLE PAIR SCENE ==========
    # Function: Method clash and fusion. Chaos meets structure.
    # Aeron present at end—witnesses but doesn't drive the scene.

    # ========== INTEL DEN — LATER THAT DAY ==========

    "Aeron returns to the Intel Den to find it transformed."

    "Zira has set up her portable Ghostline rig next to Noelle's pristine workstation. The aesthetic clash is almost painful—cables spilling across organized surfaces, amber light bleeding into silver-blue."

    # VISUAL: Zira and Noelle at adjacent workstations. Arguing. Or collaborating. Hard to tell.
    "They're both talking. At the same time. About different things. Or the same things from different angles."

    z "—the patrol variance isn't random, it's reactive. They adjust based on previous week's incident reports—"

    n "—which means we can model the adjustment algorithm if we have sufficient historical data—"

    z "—but historical data doesn't account for the human element. Sergeants get lazy, officers get drunk—"

    n "—human variance is a calculable factor, not an exception—"

    z "—you can't calculate a hangover, Noelle—"

    n "—you can calculate the probability of a hangover based on behavioral patterns—"

    "Aeron stands in the doorway. Neither of them has noticed him."

    athought "This is either collaboration or a very sophisticated argument. Possibly both."

    # VISUAL: Aeron leaning against the doorframe, watching. The two women too absorbed to notice.
    "He decides to watch. See how this plays out."

    z "Okay, fine. Run your algorithm on Sector 7. Tell me what the patrol timing should be."

    n "(typing rapidly) Based on historical data, incident correlation, and behavioral variance modeling..."
    n "The patrol window should be twelve minutes, with a two-minute uncertainty buffer."

    z "It's eight. I timed it myself last night."

    n "That's a thirty-three percent deviation from the model. That's not possible."

    z "And yet."

    "Noelle stares at her screen. Her model. The data that's telling her one thing while reality says another."

    n "There must be an unaccounted variable."

    z "There's always an unaccounted variable. That's my whole point."
    z "Your models are beautiful, Noelle. They really are. But the Unders doesn't run on models."
    z "It runs on people. And people are—"

    n "Chaotic. Unpredictable. Irrational."

    z "I was going to say 'complicated,' but sure."

    "Noelle leans back in her chair. For a moment, she looks almost... defeated."

    n "Then how do you operate? If nothing is predictable?"

    z "I don't predict. I react."
    z "I build systems that are flexible enough to survive being wrong."
    z "Ghostline doesn't assume it knows where the patrols will be. It watches where they actually are and adjusts in real time."

    n "That's... inefficient."

    z "That's survival."

    # ========== THE BREAKTHROUGH ==========

    "Silence. The hum of processors filling the gap."

    "Then Noelle does something Aeron doesn't expect. She laughs."

    "It's small. Surprised. Like she doesn't quite recognize the sound coming from her own throat."

    n "You're right."

    z "(stunned) I'm sorry, did you just say—"

    n "Don't make me repeat it."
    n "My model is wrong because I was trying to predict behavior instead of observing it."
    n "Your approach is inefficient, but it's more accurate because it doesn't pretend to know things it can't know."

    z "(grinning) That might be the most romantic thing you've ever said to me."

    n "I wasn't—that's not—"

    z "I'm kidding. Mostly."

    "Noelle's ears turn pink again. She focuses very intently on her screen."

    n "What if we combined the approaches?"

    z "What do you mean?"

    n "Your Ghostline provides real-time observation. My models provide pattern recognition."
    n "If we feed your live data into my predictive framework..."

    z "We'd have a system that learns from what's actually happening instead of what should be happening."

    n "Exactly."
    n "The algorithm would update itself based on observed variance. Over time, it would become more accurate, not less."

    "Zira stares at her. Then at the screens. Then back at her."

    z "That's... actually brilliant."

    n "I know."

    z "And modest."

    n "Modesty is an inefficient use of cognitive resources."

    # VISUAL: The two of them leaning in, working together now. The screens showing a merge of their data—amber and blue combining.
    "They work. For the first time, moving in sync instead of opposition."

    "Zira's fingers flying across her Ghostline interface, feeding live patrol data into Noelle's framework."

    "Noelle's algorithms churning, adjusting, learning."

    z "There—Sector 4 patrol just deviated. They're cutting through the market corridor."

    n "Updating... model now predicts a twelve percent higher probability of market corridor usage during shift changes."
    n "If this holds, we can use that corridor as an ambush point."

    z "Or an escape route."

    n "Or both, depending on tactical need."

    z "(quietly impressed) You really are good at this.

    n "(quietly pleased) ...Thank you. You're surprisingly adequate as well."

    z "Be still my heart."

    # ========== AERON ENTERS ==========

    "He steps into the room. Both women look up, startled."

    z "How long have you been standing there?"

    a "Long enough to see you two invent a new surveillance system."

    n "It's not a surveillance system. It's an adaptive tactical prediction framework."

    a "Right. That's what I said."

    z "(to Noelle) He's messing with you."

    n "I'm aware. I was responding in kind."
    n "(beat) That was a joke."

    z "You're getting better at those."

    n "I've been practicing."

    "Aeron looks between them. Something has shifted since he left."

    a "You two work well together."

    z "Don't sound so surprised."

    a "I'm not. I'm impressed."
    a "Selene's been trying to find a tactical edge for years. You just built one in an afternoon."

    n "It's still theoretical. We need to test it in field conditions."

    z "Which means more operations. More data. More chances for your boyfriend to prove himself."

    n "He's not my—that's not—"

    z "(to Aeron) She gets flustered when I tease her about you. It's adorable."

    n "I don't get flustered. I experience momentary cognitive disruption due to unexpected social parameters."

    z "That's what I said."

    if empathy_band() == "obedience":
        athought "They're going to be useful together. Their combined approach covers blind spots neither had alone."
        athought "And Zira's right—Noelle does get flustered. That's interesting data."
    else:
        athought "They've found something. In the work, and maybe in each other."
        athought "It's strange, watching people connect. Remembering what that looks like from the outside."

    # ========== CLOSING — THE FUSION ==========

    n "The framework will take time to optimize. But the foundation is solid."
    n "I'll have preliminary projections for the base acquisition scenarios by tomorrow."

    a "Selene mentioned base options. Multiple locations?"

    z "Four candidates. Each one has pros and cons."
    z "We're going to need input from everyone—you, Lyra, Tessa, Noelle."

    n "And ultimately, Selene makes the call."

    a "But the data will help her decide."

    n "That's the theory."

    "She turns back to her screens. Then pauses."

    n "Captain."

    a "Aeron. You can call me Aeron."

    n "...Aeron."
    n "The work Zira and I did today—it only matters if you keep operating."
    n "Every mission generates data. Every choice feeds the model."
    n "Don't die. It would waste considerable analytical resources."

    z "(translating) She's saying she wants you to stay alive because she cares about you."

    n "That's not what I—"

    z "It is."

    n "(very quietly) ...Perhaps partially."

    a "I'll do my best not to waste your resources, Noelle."

    n "See that you don't."

    "She turns back to her work. But there's the faintest trace of a smile on her face."

    # VISUAL: Aeron and Zira leaving, Noelle absorbed in her screens, but something lighter in her posture.
    "They leave her with her algorithms and her data and her single struggling plant."

    z "(once they're outside) She really does like you, you know."

    a "I got that impression."

    z "Don't break her. She's more fragile than she looks."
    z "All that data is armor. Underneath, she's just someone who's afraid of being wrong about everything."

    a "Aren't we all?"

    z "Some of us more than others."

    "They walk through the Unders corridors. Tomorrow, base selection. Tonight, the rare luxury of something like peace."

    # --- SCENE WRAP ---
    $ flag_on("Zira", "noelle_partnership_formed")
    $ flag_on("Noelle", "zira_partnership_formed")
    $ scene_mark(_current_scene_id, "completed")
    return


# ========= CANONICAL NOTES =========
# cann.scene_id: act2_15_algorithm_of_chaos
# cann.chapter: Act II, Chapter III — Proving Ground
# cann.chapter_start: False
# cann.when_in_timeline:
#   - Day 7, later. After Intel Den debrief. Same day.
# cann.what_happened:
#   - Aeron returns to find Zira and Noelle arguing/collaborating.
#   - Method clash: Noelle's predictive models vs Zira's real-time observation.
#   - Noelle's model says 12-minute patrol window; Zira observed 8 minutes.
#   - Breakthrough: Combine approaches—Ghostline feeds live data into adaptive algorithm.
#   - The system learns from observed variance instead of predicted behavior.
#   - Noelle laughs (surprised by herself). Admits Zira is right.
#   - Zira teases Noelle about Aeron—"cognitive disruption due to unexpected social parameters."
#   - Noelle: "Don't die. It would waste considerable analytical resources."
#   - Zira translates: "She's saying she cares about you."
# cann.aeron_state:
#   - Observer role in this scene—witnesses the Zira/Noelle dynamic.
#   - Impressed by their fusion. Processing what it means to watch people connect.
# cann.path_tracking:
#   - No empathy choices in this scene—it's a pair scene, Aeron is peripheral.
#   - Partnership flags set for both Zira and Noelle.
#   - Running empathy range at scene end: -16 to +6 (unchanged).
# cann.thematic_flags:
#   - Core pair dynamic: Chaos vs Structure, both valid, fusion stronger.
#   - Noelle's humanity breaking through: surprise laugh, admitting she was wrong.
#   - "Don't die" as Noelle's version of affection.
#   - Zira as translator/protector: "Don't break her. She's more fragile than she looks."
# cann.alignment_flavor_points:
#   - Aeron's internal observations vary by band (tactical assessment vs emotional recognition).
# cann.character_moments:
#   - Noelle: Laughs, admits she's wrong, gets flustered about Aeron. Growing.
#   - Zira: Bridges chaos and structure. Protective of Noelle. Teasing but affectionate.
#   - Their partnership is a genuine intellectual romance—not romantic, but intimate.
# cann.worldbuilding:
#   - Adaptive tactical prediction framework—game-changer for resistance operations.
#   - Four base candidates mentioned—sets up dynamic base selection.
# cann.block_status:
#   - A2_P12 pair anchor complete. Zira×Noelle dynamic established.
# cann.requires_followup:
#   - The adaptive framework will be used in future operations.
#   - Base selection scene coming next—input from all LIs.
#   - Noelle's growing attachment to Aeron should continue developing.
#   - "Don't break her" echoes in later Aeron/Noelle interactions.
